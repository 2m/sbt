<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>Incremental.scala</title>
        <script type="text/javascript" src="jquery-all.js"></script>
        <script type="text/javascript" src="linked.js"></script>
        <link rel="stylesheet" type="text/css" href="style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* sbt -- Simple Build Tool
 * Copyright 2010  Mark Harrah
 */</span>
<span class="keyword">package</span> sbt
<span class="keyword">package</span> inc

<span class="keyword">import</span> xsbt.api.<span class="delimiter">{</span>NameChanges, SameAPI, TopLevel<span class="delimiter">}</span>
<span class="keyword">import</span> annotation.tailrec
<span class="keyword">import</span> xsbti.api.<span class="delimiter">{</span>Compilation, Source<span class="delimiter">}</span>
<span class="keyword">import</span> java.io.File

<span class="keyword">object</span> <a title="object sbt.inc.Incremental" id="18955">Incremental</a>
<span title="ScalaObject" class="delimiter">{</span>
	<span class="keyword">def</span> <a title="(s: =&gt; String)Unit" id="112382">debug</a><span class="delimiter">(</span><a title="=&gt; String" id="117065">s</a>: =&gt; String<span class="delimiter">)</span> = <span title="Unit" class="keyword">if</span><span class="delimiter">(</span>java.lang.<span title="object java.lang.Boolean">Boolean</span>.<span title="(x$1: java.lang.String)Boolean">getBoolean</span><span class="delimiter">(</span><span title="java.lang.String(&quot;xsbt.inc.debug&quot;)" class="string">&quot;xsbt.inc.debug&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="#117065" title="=&gt; String">s</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
	<span class="keyword">def</span> <a title="(sources: Set[java.io.File],entry: (String) =&gt; Option[java.io.File],previous: sbt.inc.Analysis,current: sbt.inc.ReadStamps,forEntry: (java.io.File) =&gt; Option[sbt.inc.Analysis],doCompile: (Set[java.io.File]) =&gt; sbt.inc.Analysis,log: sbt.Logger)(implicit equivS: Equiv[sbt.inc.Stamp])(Boolean, sbt.inc.Analysis)" id="112383">compile</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="112402">sources</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="(String) =&gt; Option[java.io.File]" id="112403">entry</a>: String =&gt; Option<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.inc.Analysis" id="112404">previous</a>: <a href="Analysis.scala.html#18789" title="sbt.inc.Analysis">Analysis</a>, <a title="sbt.inc.ReadStamps" id="112405">current</a>: <a href="Stamp.scala.html#19068" title="sbt.inc.ReadStamps">ReadStamps</a>, <a title="(java.io.File) =&gt; Option[sbt.inc.Analysis]" id="112406">forEntry</a>: File =&gt; Option<span class="delimiter">[</span>Analysis<span class="delimiter">]</span>, <a title="(Set[java.io.File]) =&gt; sbt.inc.Analysis" id="112407">doCompile</a>: Set<span class="delimiter">[</span>File<span class="delimiter">]</span> =&gt; Analysis, <a title="sbt.Logger" id="112408">log</a>: <a href="Logger.scala.html#9286" title="sbt.Logger">Logger</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Equiv[sbt.inc.Stamp]" id="112409">equivS</a>: <span title="Equiv[sbt.inc.Stamp]">Equiv</span><span class="delimiter">[</span>Stamp<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(Boolean, sbt.inc.Analysis)" class="delimiter">(</span>Boolean, Analysis<span class="delimiter">)</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="sbt.inc.InitialChanges" id="117072">initialChanges</a> = <a href="#112391" title="(entry: (String) =&gt; Option[java.io.File],sources: Set[java.io.File],previousAnalysis: sbt.inc.Analysis,current: sbt.inc.ReadStamps,forEntry: (java.io.File) =&gt; Option[sbt.inc.Analysis])(implicit equivS: Equiv[sbt.inc.Stamp])sbt.inc.InitialChanges">changedInitial</a><a href="#112409" title="Equiv[sbt.inc.Stamp]" class="delimiter">(</a><a href="#112403" title="(String) =&gt; Option[java.io.File]">entry</a>, <a href="#112402" title="Set[java.io.File]">sources</a>, <a href="#112404" title="sbt.inc.Analysis">previous</a>, <a href="#112405" title="sbt.inc.ReadStamps">current</a>, <a href="#112406" title="(java.io.File) =&gt; Option[sbt.inc.Analysis]">forEntry</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="Set[java.io.File]" id="117073">initialInv</a> = <a href="#112396" title="(previous: sbt.inc.Relations,changes: sbt.inc.InitialChanges,log: sbt.Logger)Set[java.io.File]">invalidateInitial</a><span class="delimiter">(</span><a href="#112404" title="sbt.inc.Analysis">previous</a>.<a href="Analysis.scala.html#111427" title="=&gt; sbt.inc.Relations">relations</a>, <a href="#117072" title="sbt.inc.InitialChanges">initialChanges</a>, <a href="#112408" title="sbt.Logger">log</a><span class="delimiter">)</span>
		<a href="#112408" title="sbt.Logger">log</a>.<a href="Logger.scala.html#54087" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;Initially invalidated: &quot;</span> + <a href="#117073" title="Set[java.io.File]">initialInv</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="sbt.inc.Analysis" id="117074">analysis</a> = <a href="#112384" title="(invalidated: Set[java.io.File],previous: sbt.inc.Analysis,doCompile: (Set[java.io.File]) =&gt; sbt.inc.Analysis,log: sbt.Logger)sbt.inc.Analysis">cycle</a><span class="delimiter">(</span><a href="#117073" title="Set[java.io.File]">initialInv</a>, <a href="#112404" title="sbt.inc.Analysis">previous</a>, <a href="#112407" title="(Set[java.io.File]) =&gt; sbt.inc.Analysis">doCompile</a>, <a href="#112408" title="sbt.Logger">log</a><span class="delimiter">)</span>
		<span title="(_1: Boolean,_2: sbt.inc.Analysis)(Boolean, sbt.inc.Analysis)" class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#117073" title="Set[java.io.File]">initialInv</a>.<span title="=&gt; Boolean">isEmpty</span>, <a href="#117074" title="sbt.inc.Analysis">analysis</a><span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="comment">// TODO: the Analysis for the last successful compilation should get returned + Boolean indicating success</span>
	<span class="comment">// TODO: full external name changes, scopeInvalidations</span>
	<span class="keyword">def</span> <a title="(invalidated: Set[java.io.File],previous: sbt.inc.Analysis,doCompile: (Set[java.io.File]) =&gt; sbt.inc.Analysis,log: sbt.Logger)sbt.inc.Analysis" id="112384">cycle</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="117096">invalidated</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.inc.Analysis" id="117097">previous</a>: <a href="Analysis.scala.html#18789" title="sbt.inc.Analysis">Analysis</a>, <a title="(Set[java.io.File]) =&gt; sbt.inc.Analysis" id="117098">doCompile</a>: Set<span class="delimiter">[</span>File<span class="delimiter">]</span> =&gt; Analysis, <a title="sbt.Logger" id="117099">log</a>: <a href="Logger.scala.html#9286" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <a href="Analysis.scala.html#18789" title="sbt.inc.Analysis">Analysis</a> =
		<span title="sbt.inc.Analysis" class="keyword">if</span><span class="delimiter">(</span><a href="#117096" title="Set[java.io.File]">invalidated</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
			<a href="#117097" title="sbt.inc.Analysis">previous</a>
		<span class="keyword">else</span>
		<span class="delimiter">{</span>
			<span class="keyword">val</span> <a title="sbt.inc.Analysis" id="117109">pruned</a> = <a href="#112397" title="(invalidatedSrcs: Set[java.io.File],previous: sbt.inc.Analysis)sbt.inc.Analysis">prune</a><span class="delimiter">(</span><a href="#117096" title="Set[java.io.File]">invalidated</a>, <a href="#117097" title="sbt.inc.Analysis">previous</a><span class="delimiter">)</span>
			<a href="#112382" title="(s: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;********* Pruned: \n&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#117109" title="sbt.inc.Analysis">pruned</a>.<a href="Analysis.scala.html#111427" title="=&gt; sbt.inc.Relations">relations</a> + <span title="java.lang.String(&quot;\012*********&quot;)" class="string">&quot;\n*********&quot;</span><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="sbt.inc.Analysis" id="117110">fresh</a> = <a href="#117098" title="(v1: Set[java.io.File])sbt.inc.Analysis">doCompile</a><span class="delimiter">(</span><a href="#117096" title="Set[java.io.File]">invalidated</a><span class="delimiter">)</span>
			<a href="#112382" title="(s: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;********* Fresh: \n&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#117110" title="sbt.inc.Analysis">fresh</a>.<a href="Analysis.scala.html#111427" title="=&gt; sbt.inc.Relations">relations</a> + <span title="java.lang.String(&quot;\012*********&quot;)" class="string">&quot;\n*********&quot;</span><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="sbt.inc.Analysis" id="117111">merged</a> = <a href="Analysis.scala.html#111428" title="(other: sbt.inc.Analysis)sbt.inc.Analysis">pruned</a> ++ <a href="#117110" title="sbt.inc.Analysis">fresh</a><span class="comment">//.copy(relations = pruned.relations ++ fresh.relations, apis = pruned.apis ++ fresh.apis)</span>
			<a href="#112382" title="(s: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;********* Merged: \n&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#117111" title="sbt.inc.Analysis">merged</a>.<a href="Analysis.scala.html#111427" title="=&gt; sbt.inc.Relations">relations</a> + <span title="java.lang.String(&quot;\012*********&quot;)" class="string">&quot;\n*********&quot;</span><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="sbt.inc.APIChanges[java.io.File]" id="117112">incChanges</a> = <a href="#112385" title="(lastSources: scala.collection.Set[java.io.File],oldAPI: (java.io.File) =&gt; xsbti.api.Source,newAPI: (java.io.File) =&gt; xsbti.api.Source)sbt.inc.APIChanges[java.io.File]">changedIncremental</a><span class="delimiter">(</span><a href="#117096" title="Set[java.io.File]">invalidated</a>, <a href="#117097" title="sbt.inc.Analysis">previous</a>.<a href="Analysis.scala.html#111426" title="=&gt; sbt.inc.APIs">apis</a>.<a href="APIs.scala.html#110992" title="(src: java.io.File)xsbti.api.Source">internalAPI</a> _, <a href="#117111" title="sbt.inc.Analysis">merged</a>.<a href="Analysis.scala.html#111426" title="=&gt; sbt.inc.APIs">apis</a>.<a href="APIs.scala.html#110992" title="(src: java.io.File)xsbti.api.Source">internalAPI</a> _<span class="delimiter">)</span>
			<a href="#112382" title="(s: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;Changes:\n&quot;</span> + <a href="#117112" title="sbt.inc.APIChanges[java.io.File]">incChanges</a><span class="delimiter">)</span>
			<span class="keyword">val</span> <a title="Set[java.io.File]" id="117113">incInv</a> = <a href="#112393" title="(previous: sbt.inc.Relations,changes: sbt.inc.APIChanges[java.io.File],recompiledSources: Set[java.io.File],log: sbt.Logger)Set[java.io.File]">invalidateIncremental</a><span class="delimiter">(</span><a href="#117111" title="sbt.inc.Analysis">merged</a>.<a href="Analysis.scala.html#111427" title="=&gt; sbt.inc.Relations">relations</a>, <a href="#117112" title="sbt.inc.APIChanges[java.io.File]">incChanges</a>, <a href="#117096" title="Set[java.io.File]">invalidated</a>, <a href="#117099" title="sbt.Logger">log</a><span class="delimiter">)</span>
			<a href="#117099" title="sbt.Logger">log</a>.<a href="Logger.scala.html#54087" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;Incrementally invalidated: &quot;</span> + <a href="#117113" title="Set[java.io.File]">incInv</a><span class="delimiter">)</span>
			<a href="#112384" title="(invalidated: Set[java.io.File],previous: sbt.inc.Analysis,doCompile: (Set[java.io.File]) =&gt; sbt.inc.Analysis,log: sbt.Logger)sbt.inc.Analysis">cycle</a><span class="delimiter">(</span><a href="#117113" title="Set[java.io.File]">incInv</a>, <a href="#117111" title="sbt.inc.Analysis">merged</a>, <a href="#117098" title="(Set[java.io.File]) =&gt; sbt.inc.Analysis">doCompile</a>, <a href="#117099" title="sbt.Logger">log</a><span class="delimiter">)</span>
		<span class="delimiter">}</span>
	

	<span class="comment">/**
	* Accepts the sources that were recompiled during the last step and functions
	* providing the API before and after the last step.  The functions should return
	* an empty API if the file did not/does not exist.
	*/</span>
	<span class="keyword">def</span> <a title="[T](lastSources: scala.collection.Set[T],oldAPI: (T) =&gt; xsbti.api.Source,newAPI: (T) =&gt; xsbti.api.Source)sbt.inc.APIChanges[T]" id="112385">changedIncremental</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="112387">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.Set[T]" id="117130">lastSources</a>: collection.<span title="scala.collection.Set[T]">Set</span><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="(T) =&gt; xsbti.api.Source" id="117131">oldAPI</a>: T =&gt; Source, <a title="(T) =&gt; xsbti.api.Source" id="117132">newAPI</a>: T =&gt; Source<span class="delimiter">)</span>: <a href="Changes.scala.html#18834" title="sbt.inc.APIChanges[T]">APIChanges</a><span class="delimiter">[</span>T<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="Seq[xsbti.api.Source]" id="117170">oldApis</a> = <a href="#117130" title="scala.collection.Set[T]">lastSources</a>.<span title="(f: (T) =&gt; xsbti.api.Source)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[T],xsbti.api.Source,Seq[xsbti.api.Source]])Seq[xsbti.api.Source]">toSeq</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,xsbti.api.Source,Seq[xsbti.api.Source]]">map</span> <a href="#117131" title="(T) =&gt; xsbti.api.Source">oldAPI</a>
		<span class="keyword">val</span> <a title="Seq[xsbti.api.Source]" id="117171">newApis</a> = <a href="#117130" title="scala.collection.Set[T]">lastSources</a>.<span title="(f: (T) =&gt; xsbti.api.Source)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[T],xsbti.api.Source,Seq[xsbti.api.Source]])Seq[xsbti.api.Source]">toSeq</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,xsbti.api.Source,Seq[xsbti.api.Source]]">map</span> <a href="#117132" title="(T) =&gt; xsbti.api.Source">newAPI</a>
		<span class="keyword">val</span> <a title="(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])" id="117172">changes</a> = <span title="(_1: scala.collection.Set[T],_2: Seq[xsbti.api.Source],_3: Seq[xsbti.api.Source])(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])" class="delimiter">(</span><a href="#117130" title="scala.collection.Set[T]">lastSources</a>, <a href="#117170" title="Seq[xsbti.api.Source]">oldApis</a>, <a href="#117171" title="Seq[xsbti.api.Source]">newApis</a><span class="delimiter">)</span>.<span title="(implicit w1: (scala.collection.Set[T]) =&gt; scala.collection.TraversableLike[T,scala.collection.Set[T]],implicit w2: (Seq[xsbti.api.Source]) =&gt; scala.collection.IterableLike[xsbti.api.Source,Seq[xsbti.api.Source]],implicit w3: (Seq[xsbti.api.Source]) =&gt; scala.collection.IterableLike[xsbti.api.Source,Seq[xsbti.api.Source]])(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])#Zipped[scala.collection.Set[T],T,Seq[xsbti.api.Source],xsbti.api.Source,Seq[xsbti.api.Source],xsbti.api.Source]">zipped</span>.<span title="(f: (T, xsbti.api.Source, xsbti.api.Source) =&gt; Boolean)(implicit cbf1: scala.collection.generic.CanBuildFrom[scala.collection.Set[T],T,scala.collection.Set[T]],implicit cbf2: scala.collection.generic.CanBuildFrom[Seq[xsbti.api.Source],xsbti.api.Source,Seq[xsbti.api.Source]],implicit cbf3: scala.collection.generic.CanBuildFrom[Seq[xsbti.api.Source],xsbti.api.Source,Seq[xsbti.api.Source]])(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])">filter</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Set.Coll,T,scala.collection.Set[T]]" class="delimiter">{</span> <span class="delimiter">(</span><a title="T" id="117378">src</a>, <a title="xsbti.api.Source" id="117379">oldApi</a>, <a title="xsbti.api.Source" id="117380">newApi</a><span class="delimiter">)</span> =&gt; <span title="=&gt; Boolean">!</span><a href="#112388" title="(a: xsbti.api.Source,b: xsbti.api.Source)Boolean">sameSource</a><span class="delimiter">(</span><a href="#117379" title="xsbti.api.Source">oldApi</a>, <a href="#117380" title="xsbti.api.Source">newApi</a><span class="delimiter">)</span> <span class="delimiter">}</span>

		<span class="keyword">val</span> <a title="xsbt.api.NameChanges" id="117173">changedNames</a> = <a href="SameAPI.scala.html#18501" title="object xsbt.api.TopLevel">TopLevel</a>.<a href="SameAPI.scala.html#96555" title="(a: Iterable[xsbti.api.Source],b: Iterable[xsbti.api.Source])xsbt.api.NameChanges">nameChanges</a><span class="delimiter">(</span><a href="#117172" title="(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])">changes</a>.<span title="=&gt; Seq[xsbti.api.Source]">_3</span>, <a href="#117172" title="(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])">changes</a>.<span title="=&gt; Seq[xsbti.api.Source]">_2</span> <span class="delimiter">)</span>

		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[T]" id="117174">modifiedAPIs</a> = <a href="#117172" title="(scala.collection.Set[T], Seq[xsbti.api.Source], Seq[xsbti.api.Source])">changes</a>.<span title="=&gt; scala.collection.Set[T]">_1</span>.<span title="scala.collection.immutable.Set[T]">toSet</span>

		<span title="sbt.inc.APIChanges[T]" class="keyword">new</span> <a href="Changes.scala.html#18834" title="sbt.inc.APIChanges[T]">APIChanges</a><span class="delimiter">(</span><a href="#117174" title="scala.collection.immutable.Set[T]">modifiedAPIs</a>, <a href="#117173" title="xsbt.api.NameChanges">changedNames</a><span class="delimiter">)</span>
	<span class="delimiter">}</span>
	<span class="keyword">def</span> <a title="(a: xsbti.api.Source,b: xsbti.api.Source)Boolean" id="112388">sameSource</a><span class="delimiter">(</span><a title="xsbti.api.Source" id="117381">a</a>: <a href="xsbti/api/Source.java.html#19381" title="xsbti.api.Source">Source</a>, <a title="xsbti.api.Source" id="117382">b</a>: <a href="xsbti/api/Source.java.html#19381" title="xsbti.api.Source">Source</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span>  =  <a href="#112389" title="(a: xsbti.api.Source,b: xsbti.api.Source)Boolean">shortcutSameSource</a><span title="(x$1: Boolean)Boolean" class="delimiter">(</span><a href="#117381" title="xsbti.api.Source">a</a>, <a href="#117382" title="xsbti.api.Source">b</a><span class="delimiter">)</span> || <a href="SameAPI.scala.html#96675" title="(a: xsbti.api.SourceAPI,b: xsbti.api.SourceAPI)Boolean">SameAPI</a><span class="delimiter">(</span><a href="#117381" title="xsbti.api.Source">a</a>.<a href="xsbti/api/Source.java.html#96573" title="()xsbti.api.SourceAPI">api</a>, <a href="#117382" title="xsbti.api.Source">b</a>.<a href="xsbti/api/Source.java.html#96573" title="()xsbti.api.SourceAPI">api</a><span class="delimiter">)</span>
	<span class="keyword">def</span> <a title="(a: xsbti.api.Source,b: xsbti.api.Source)Boolean" id="112389">shortcutSameSource</a><span class="delimiter">(</span><a title="xsbti.api.Source" id="117579">a</a>: <a href="xsbti/api/Source.java.html#19381" title="xsbti.api.Source">Source</a>, <a title="xsbti.api.Source" id="117580">b</a>: <a href="xsbti/api/Source.java.html#19381" title="xsbti.api.Source">Source</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span>  =  <span title="(x$1: Boolean)Boolean">!</span><a href="#117579" title="xsbti.api.Source">a</a>.<a href="xsbti/api/Source.java.html#96572" title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">hash</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x$1: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#117580" title="xsbti.api.Source">b</a>.<a href="xsbti/api/Source.java.html#96572" title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">hash</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x$1: Boolean)Boolean">&amp;&amp;</span> <a href="#112390" title="(a: xsbti.api.Compilation,b: xsbti.api.Compilation)Boolean">sameCompilation</a><span class="delimiter">(</span><a href="#117579" title="xsbti.api.Source">a</a>.<a href="xsbti/api/Source.java.html#96571" title="()xsbti.api.Compilation">compilation</a>, <a href="#117580" title="xsbti.api.Source">b</a>.<a href="xsbti/api/Source.java.html#96571" title="()xsbti.api.Compilation">compilation</a><span class="delimiter">)</span> &amp;&amp; <span class="delimiter">(</span><a href="#117579" title="xsbti.api.Source">a</a>.<a href="xsbti/api/Source.java.html#96572" title="(that: Any)Boolean">hash</a> deepEquals <a href="#117580" title="xsbti.api.Source">b</a>.<a href="xsbti/api/Source.java.html#96572" title="()Array[Byte]">hash</a><span class="delimiter">)</span>
	<span class="keyword">def</span> <a title="(a: xsbti.api.Compilation,b: xsbti.api.Compilation)Boolean" id="112390">sameCompilation</a><span class="delimiter">(</span><a title="xsbti.api.Compilation" id="118047">a</a>: <a href="xsbti/api/Compilation.java.html#19291" title="xsbti.api.Compilation">Compilation</a>, <a title="xsbti.api.Compilation" id="118048">b</a>: <a href="xsbti/api/Compilation.java.html#19291" title="xsbti.api.Compilation">Compilation</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span>  =  <a href="#118047" title="xsbti.api.Compilation">a</a>.<a href="xsbti/api/Compilation.java.html#111073" title="(x$1: Long)Boolean">startTime</a> <span title="(x$1: Boolean)Boolean">==</span> <a href="#118048" title="xsbti.api.Compilation">b</a>.<a href="xsbti/api/Compilation.java.html#111073" title="()Long">startTime</a> &amp;&amp; <a href="#118047" title="xsbti.api.Compilation">a</a>.<a href="xsbti/api/Compilation.java.html#111074" title="(x$1: AnyRef)Boolean">target</a> == <a href="#118048" title="xsbti.api.Compilation">b</a>.<a href="xsbti/api/Compilation.java.html#111074" title="()java.lang.String">target</a>

	<span class="keyword">def</span> <a title="(entry: (String) =&gt; Option[java.io.File],sources: Set[java.io.File],previousAnalysis: sbt.inc.Analysis,current: sbt.inc.ReadStamps,forEntry: (java.io.File) =&gt; Option[sbt.inc.Analysis])(implicit equivS: Equiv[sbt.inc.Stamp])sbt.inc.InitialChanges" id="112391">changedInitial</a><span class="delimiter">(</span><a title="(String) =&gt; Option[java.io.File]" id="117075">entry</a>: String =&gt; Option<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="117076">sources</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.inc.Analysis" id="117077">previousAnalysis</a>: <a href="Analysis.scala.html#18789" title="sbt.inc.Analysis">Analysis</a>, <a title="sbt.inc.ReadStamps" id="117078">current</a>: <a href="Stamp.scala.html#19068" title="sbt.inc.ReadStamps">ReadStamps</a>, <a title="(java.io.File) =&gt; Option[sbt.inc.Analysis]" id="117079">forEntry</a>: File =&gt; Option<span class="delimiter">[</span>Analysis<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Equiv[sbt.inc.Stamp]" id="117080">equivS</a>: <span title="Equiv[sbt.inc.Stamp]">Equiv</span><span class="delimiter">[</span>Stamp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="Changes.scala.html#18984" title="sbt.inc.InitialChanges">InitialChanges</a> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="sbt.inc.Stamps" id="118137">previous</a> = <a href="#117077" title="sbt.inc.Analysis">previousAnalysis</a>.<a href="Analysis.scala.html#111425" title="=&gt; sbt.inc.Stamps">stamps</a>
		<span class="keyword">val</span> <a title="sbt.inc.APIs" id="118138">previousAPIs</a> = <a href="#117077" title="sbt.inc.Analysis">previousAnalysis</a>.<a href="Analysis.scala.html#111426" title="=&gt; sbt.inc.APIs">apis</a>
		
		<span class="keyword">val</span> <a title="sbt.inc.Changes[java.io.File]" id="118139">srcChanges</a> = <a href="#112392" title="(previous: Set[java.io.File],current: Set[java.io.File],existingModified: (java.io.File) =&gt; Boolean)sbt.inc.Changes[java.io.File]">changes</a><span class="delimiter">(</span><a href="#118137" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#111449" title="=&gt; scala.collection.Set[java.io.File]">allInternalSources</a>.<span title="scala.collection.immutable.Set[java.io.File]">toSet</span>, <a href="#117076" title="Set[java.io.File]">sources</a>,  <a title="java.io.File" id="118154">f</a> =&gt; <span title="=&gt; Boolean">!</span><a href="#117080" title="Equiv[sbt.inc.Stamp]">equivS</a>.<span title="(x: sbt.inc.Stamp,y: sbt.inc.Stamp)Boolean">equiv</span><span class="delimiter">(</span> <a href="#118137" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#111447" title="(src: java.io.File)sbt.inc.Stamp">internalSource</a><span class="delimiter">(</span><a href="#118154" title="java.io.File">f</a><span class="delimiter">)</span>, <a href="#117078" title="sbt.inc.ReadStamps">current</a>.<a href="Stamp.scala.html#111447" title="(src: java.io.File)sbt.inc.Stamp">internalSource</a><span class="delimiter">(</span><a href="#118154" title="java.io.File">f</a><span class="delimiter">)</span> <span class="delimiter">)</span> <span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="118140">removedProducts</a> = <a href="#118137" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#111451" title="=&gt; scala.collection.Set[java.io.File]">allProducts</a>.<span title="(p: (java.io.File) =&gt; Boolean)scala.collection.Set[java.io.File]">filter</span><span class="delimiter">(</span> <a title="java.io.File" id="118162">p</a> =&gt; <span title="=&gt; Boolean">!</span><a href="#117080" title="Equiv[sbt.inc.Stamp]">equivS</a>.<span title="(x: sbt.inc.Stamp,y: sbt.inc.Stamp)Boolean">equiv</span><span class="delimiter">(</span> <a href="#118137" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#111446" title="(prod: java.io.File)sbt.inc.Stamp">product</a><span class="delimiter">(</span><a href="#118162" title="java.io.File">p</a><span class="delimiter">)</span>, <a href="#117078" title="sbt.inc.ReadStamps">current</a>.<a href="Stamp.scala.html#111446" title="(prod: java.io.File)sbt.inc.Stamp">product</a><span class="delimiter">(</span><a href="#118162" title="java.io.File">p</a><span class="delimiter">)</span> <span class="delimiter">)</span> <span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[java.io.File]">toSet</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="118141">binaryDepChanges</a> = <a href="#118137" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#111450" title="=&gt; scala.collection.Set[java.io.File]">allBinaries</a>.<span title="(p: (java.io.File) =&gt; Boolean)scala.collection.Set[java.io.File]">filter</span><span class="delimiter">(</span> <a href="#112398" title="(entry: (String) =&gt; Option[java.io.File],className: (java.io.File) =&gt; Option[String],previous: sbt.inc.Stamps,current: sbt.inc.ReadStamps)(implicit equivS: Equiv[sbt.inc.Stamp])(java.io.File) =&gt; Boolean">externalBinaryModified</a><a href="#117080" title="Equiv[sbt.inc.Stamp]" class="delimiter">(</a><a href="#117075" title="(String) =&gt; Option[java.io.File]">entry</a>, <a href="#118137" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#111456" title="(bin: java.io.File)Option[String]">className</a> _, <a href="#118137" title="sbt.inc.Stamps">previous</a>, <a href="#117078" title="sbt.inc.ReadStamps">current</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="scala.collection.immutable.Set[java.io.File]">toSet</span>
		<span class="keyword">val</span> <a title="sbt.inc.APIChanges[String]" id="118142">extChanges</a> = <a href="#112385" title="(lastSources: scala.collection.Set[String],oldAPI: (String) =&gt; xsbti.api.Source,newAPI: (String) =&gt; xsbti.api.Source)sbt.inc.APIChanges[String]">changedIncremental</a><span class="delimiter">(</span><a href="#118138" title="sbt.inc.APIs">previousAPIs</a>.<a href="APIs.scala.html#110994" title="=&gt; scala.collection.Set[String]">allExternals</a>, <a href="#118138" title="sbt.inc.APIs">previousAPIs</a>.<a href="APIs.scala.html#110993" title="(ext: String)xsbti.api.Source">externalAPI</a>, <a href="#112399" title="(entry: (String) =&gt; Option[java.io.File],forEntry: (java.io.File) =&gt; Option[sbt.inc.Analysis])(String) =&gt; xsbti.api.Source">currentExternalAPI</a><span class="delimiter">(</span><a href="#117075" title="(String) =&gt; Option[java.io.File]">entry</a>, <a href="#117079" title="(java.io.File) =&gt; Option[sbt.inc.Analysis]">forEntry</a><span class="delimiter">)</span><span class="delimiter">)</span>

		<a href="Changes.scala.html#112150" title="(internalSrc: sbt.inc.Changes[java.io.File],removedProducts: Set[java.io.File],binaryDeps: Set[java.io.File],external: sbt.inc.APIChanges[String])sbt.inc.InitialChanges">InitialChanges</a><span class="delimiter">(</span><a href="#118139" title="sbt.inc.Changes[java.io.File]">srcChanges</a>, <a href="#118140" title="scala.collection.immutable.Set[java.io.File]">removedProducts</a>, <a href="#118141" title="scala.collection.immutable.Set[java.io.File]">binaryDepChanges</a>, <a href="#118142" title="sbt.inc.APIChanges[String]">extChanges</a> <span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="keyword">def</span> <a title="(previous: Set[java.io.File],current: Set[java.io.File],existingModified: (java.io.File) =&gt; Boolean)sbt.inc.Changes[java.io.File]" id="112392">changes</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="118143">previous</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="118144">current</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="(java.io.File) =&gt; Boolean" id="118145">existingModified</a>: File =&gt; Boolean<span class="delimiter">)</span>: <a href="Changes.scala.html#18849" title="sbt.inc.Changes[java.io.File]">Changes</a><span class="delimiter">[</span>File<span class="delimiter">]</span> =
		<a href="#118212" title="java.lang.Object with sbt.inc.Changes[java.io.File]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with sbt.inc.Changes[java.io.File]" id="118212">Changes</a><span class="delimiter">[</span>File<span class="delimiter">]</span>
		<span class="delimiter">{</span>
			<span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="118216">inBoth</a> = <a href="#118143" title="(that: scala.collection.Set[java.io.File])scala.collection.immutable.Set[java.io.File]">previous</a> &amp; <a href="#118144" title="Set[java.io.File]">current</a>
			<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="118218">removed</a> = <a href="#118143" title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">previous</a> -- <a href="#118216" title="=&gt; scala.collection.immutable.Set[java.io.File]">inBoth</a>
			<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="118220">added</a> = <a href="#118144" title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">current</a> -- <a href="#118216" title="=&gt; scala.collection.immutable.Set[java.io.File]">inBoth</a>
			<span class="keyword">val</span> <a href="#118223" title="(scala.collection.immutable.Set[java.io.File], scala.collection.immutable.Set[java.io.File])" class="delimiter">(</a><a href="#118222" title="scala.collection.immutable.Set[java.io.File]" id="118223">changed</a>, <a href="#118222" title="scala.collection.immutable.Set[java.io.File]" id="118225">unmodified</a><span class="delimiter">)</span> = <a href="#118216" title="=&gt; scala.collection.immutable.Set[java.io.File]">inBoth</a>.<span title="(p: (java.io.File) =&gt; Boolean)(scala.collection.immutable.Set[java.io.File], scala.collection.immutable.Set[java.io.File])">partition</span><span title="(scala.collection.immutable.Set[java.io.File], scala.collection.immutable.Set[java.io.File]) @unchecked" class="delimiter">(</span><a href="#118145" title="(java.io.File) =&gt; Boolean">existingModified</a><span class="delimiter">)</span>
		<span class="delimiter">}</span>

	<span class="keyword">def</span> <a title="(previous: sbt.inc.Relations,changes: sbt.inc.APIChanges[java.io.File],recompiledSources: Set[java.io.File],log: sbt.Logger)Set[java.io.File]" id="112393">invalidateIncremental</a><span class="delimiter">(</span><a title="sbt.inc.Relations" id="117157">previous</a>: <a href="Relations.scala.html#19074" title="sbt.inc.Relations">Relations</a>, <a title="sbt.inc.APIChanges[java.io.File]" id="117158">changes</a>: <a href="Changes.scala.html#18834" title="sbt.inc.APIChanges[java.io.File]">APIChanges</a><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="117159">recompiledSources</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.Logger" id="117160">log</a>: <a href="Logger.scala.html#9286" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="Set[java.io.File]" id="118252">inv</a> = <a href="#112395" title="(dependsOnSrc: (java.io.File) =&gt; Set[java.io.File],modified: Set[java.io.File],log: sbt.Logger)Set[java.io.File]">invalidateTransitive</a><span class="delimiter">(</span><a href="#117157" title="sbt.inc.Relations">previous</a>.<a href="Relations.scala.html#111472" title="(dep: java.io.File)Set[java.io.File]">usesInternalSrc</a> _,  <a href="#117158" title="sbt.inc.APIChanges[java.io.File]">changes</a>.<a href="Changes.scala.html#112109" title="=&gt; Set[java.io.File]">modified</a>, <a href="#117160" title="sbt.Logger">log</a><span class="delimiter">)</span><span class="comment">// ++ scopeInvalidations(previous.extAPI _, changes.modified, changes.names)</span>
		<span title="Set[java.io.File]" class="keyword">if</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#118252" title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">inv</a> -- <a href="#117159" title="Set[java.io.File]">recompiledSources</a><span class="delimiter">)</span>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span title="=&gt; collection.immutable.Set.type">Set</span>.<span title="scala.collection.immutable.Set[java.io.File]">empty</span> <span class="keyword">else</span> <a href="#118252" title="Set[java.io.File]">inv</a>
	<span class="delimiter">}</span>

	<span class="comment">/** Only invalidates direct source dependencies.  It excludes any sources that were recompiled during the previous run.
	* Callers may want to augment the returned set with 'modified' or all sources recompiled up to this point. */</span>
	<span class="keyword">def</span> <a title="(dependsOnSrc: (java.io.File) =&gt; Set[java.io.File],modified: Set[java.io.File])Set[java.io.File]" id="112394">invalidateDirect</a><span class="delimiter">(</span><a title="(java.io.File) =&gt; Set[java.io.File]" id="118268">dependsOnSrc</a>: File =&gt; Set<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="118269">modified</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
		<span title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]" class="delimiter">(</span><a href="#118269" title="(f: (java.io.File) =&gt; Traversable[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">modified</a> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]">flatMap</span> <a href="#118268" title="(java.io.File) =&gt; Set[java.io.File]">dependsOnSrc</a><span class="delimiter">)</span> -- <a href="#118269" title="Set[java.io.File]">modified</a>

	<span class="comment">/** Invalidates transitive source dependencies including `modified`.  It excludes any sources that were recompiled during the previous run.*/</span>
	@tailrec <span class="keyword">def</span> <a title="(dependsOnSrc: (java.io.File) =&gt; Set[java.io.File],modified: Set[java.io.File],log: sbt.Logger)Set[java.io.File]" id="112395">invalidateTransitive</a><span class="delimiter">(</span><a title="(java.io.File) =&gt; Set[java.io.File]" id="118253">dependsOnSrc</a>: File =&gt; Set<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="Set[java.io.File]" id="118254">modified</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.Logger" id="118255">log</a>: <a href="Logger.scala.html#9286" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="Set[java.io.File]" id="118405">newInv</a> = <a href="#112394" title="(dependsOnSrc: (java.io.File) =&gt; Set[java.io.File],modified: Set[java.io.File])Set[java.io.File]">invalidateDirect</a><span class="delimiter">(</span><a href="#118253" title="(java.io.File) =&gt; Set[java.io.File]">dependsOnSrc</a>, <a href="#118254" title="Set[java.io.File]">modified</a><span class="delimiter">)</span>
		<a href="#118255" title="sbt.Logger">log</a>.<a href="Logger.scala.html#54087" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span><span title="(x$1: Any)java.lang.String" class="string">&quot;\tInvalidated direct: &quot;</span> + <a href="#118405" title="Set[java.io.File]">newInv</a><span class="delimiter">)</span>
		<span title="Set[java.io.File]" class="keyword">if</span><span class="delimiter">(</span><a href="#118405" title="Set[java.io.File]">newInv</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#118254" title="Set[java.io.File]">modified</a> <span class="keyword">else</span> <a href="#112395" title="(dependsOnSrc: (java.io.File) =&gt; Set[java.io.File],modified: Set[java.io.File],log: sbt.Logger)Set[java.io.File]">invalidateTransitive</a><span class="delimiter">(</span><a href="#118253" title="(java.io.File) =&gt; Set[java.io.File]">dependsOnSrc</a>, <a href="#118254" title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">modified</a> ++ <a href="#118405" title="Set[java.io.File]">newInv</a>, <a href="#118255" title="sbt.Logger">log</a><span class="delimiter">)</span>
	<span class="delimiter">}</span>

	<span class="comment">/** Invalidates sources based on initially detected 'changes' to the sources, products, and dependencies.*/</span>
	<span class="keyword">def</span> <a title="(previous: sbt.inc.Relations,changes: sbt.inc.InitialChanges,log: sbt.Logger)Set[java.io.File]" id="112396">invalidateInitial</a><span class="delimiter">(</span><a title="sbt.inc.Relations" id="117085">previous</a>: <a href="Relations.scala.html#19074" title="sbt.inc.Relations">Relations</a>, <a title="sbt.inc.InitialChanges" id="117086">changes</a>: <a href="Changes.scala.html#18984" title="sbt.inc.InitialChanges">InitialChanges</a>, <a title="sbt.Logger" id="117087">log</a>: <a href="Logger.scala.html#9286" title="sbt.Logger">Logger</a><span class="delimiter">)</span>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span> =
	<span class="delimiter">{</span>
		<span class="keyword">val</span> <a title="sbt.inc.Changes[java.io.File]" id="118453">srcChanges</a> = <a href="#117086" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#112088" title="=&gt; sbt.inc.Changes[java.io.File]">internalSrc</a>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="118454">srcDirect</a> = <a href="#118453" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#112104" title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">removed</a> <span title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#118453" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#112104" title="=&gt; Set[java.io.File]">removed</a>.<span title="(f: (java.io.File) =&gt; Traversable[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#117085" title="sbt.inc.Relations">previous</a>.<a href="Relations.scala.html#111472" title="(dep: java.io.File)Set[java.io.File]">usesInternalSrc</a><span class="delimiter">)</span> <span title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#118453" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#112103" title="=&gt; Set[java.io.File]">added</a> ++ <a href="#118453" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#112105" title="=&gt; Set[java.io.File]">changed</a>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="118455">byProduct</a> = <a href="#117086" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#112090" title="=&gt; Set[java.io.File]">removedProducts</a>.<span title="(f: (java.io.File) =&gt; Traversable[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#117085" title="sbt.inc.Relations">previous</a>.<a href="Relations.scala.html#111468" title="(prod: java.io.File)Set[java.io.File]">produced</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="118456">byBinaryDep</a> = <a href="#117086" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#112092" title="=&gt; Set[java.io.File]">binaryDeps</a>.<span title="(f: (java.io.File) =&gt; Traversable[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#117085" title="sbt.inc.Relations">previous</a>.<a href="Relations.scala.html#111470" title="(dep: java.io.File)Set[java.io.File]">usesBinary</a><span class="delimiter">)</span>
		<span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.io.File]" id="118457">byExtSrcDep</a> = <a href="#117086" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#112094" title="=&gt; sbt.inc.APIChanges[String]">external</a>.<a href="Changes.scala.html#112109" title="=&gt; Set[String]">modified</a>.<span title="(f: (String) =&gt; Traversable[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[String],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#117085" title="sbt.inc.Relations">previous</a>.<a href="Relations.scala.html#111474" title="(dep: String)Set[java.io.File]">usesExternal</a><span class="delimiter">)</span> <span class="comment">// ++ scopeInvalidations</span>
		<a href="#117087" title="sbt.Logger">log</a>.<a href="Logger.scala.html#54087" title="(message: =&gt; String)Unit">debug</a><span class="delimiter">(</span>
			<span title="(x$1: Any)java.lang.String" class="string">&quot;\nInitial source changes: \n\tremoved:&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#118453" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#112104" title="=&gt; Set[java.io.File]">removed</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012\011added: &quot;)" class="string">&quot;\n\tadded: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#118453" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#112103" title="=&gt; Set[java.io.File]">added</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012\011modified: &quot;)" class="string">&quot;\n\tmodified: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#118453" title="sbt.inc.Changes[java.io.File]">srcChanges</a>.<a href="Changes.scala.html#112105" title="=&gt; Set[java.io.File]">changed</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012Removed products: &quot;)" class="string">&quot;\nRemoved products: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#117086" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#112090" title="=&gt; Set[java.io.File]">removedProducts</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012Modified external sources: &quot;)" class="string">&quot;\nModified external sources: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#117086" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#112094" title="=&gt; sbt.inc.APIChanges[String]">external</a>.<a href="Changes.scala.html#112109" title="=&gt; Set[String]">modified</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012Modified binary dependencies: &quot;)" class="string">&quot;\nModified binary dependencies: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#117086" title="sbt.inc.InitialChanges">changes</a>.<a href="Changes.scala.html#112092" title="=&gt; Set[java.io.File]">binaryDeps</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012Initial directly invalidated sources: &quot;)" class="string">&quot;\nInitial directly invalidated sources: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#118454" title="scala.collection.immutable.Set[java.io.File]">srcDirect</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012\012Sources indirectly invalidated by:&quot;)" class="string">&quot;\n\nSources indirectly invalidated by:&quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012\011product: &quot;)" class="string">&quot;\n\tproduct: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#118455" title="scala.collection.immutable.Set[java.io.File]">byProduct</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012\011binary dep: &quot;)" class="string">&quot;\n\tbinary dep: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#118456" title="scala.collection.immutable.Set[java.io.File]">byBinaryDep</a> <span title="(x$1: Any)java.lang.String">+</span>
			<span title="java.lang.String(&quot;\012\011external source: &quot;)" class="string">&quot;\n\texternal source: &quot;</span> + <a href="#118457" title="scala.collection.immutable.Set[java.io.File]">byExtSrcDep</a>
		<span class="delimiter">)</span>

		<a href="#118454" title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">srcDirect</a> <span title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#118455" title="scala.collection.immutable.Set[java.io.File]">byProduct</a> <span title="(xs: scala.collection.TraversableOnce[java.io.File])scala.collection.immutable.Set[java.io.File]">++</span> <a href="#118456" title="scala.collection.immutable.Set[java.io.File]">byBinaryDep</a> ++ <a href="#118457" title="scala.collection.immutable.Set[java.io.File]">byExtSrcDep</a>
	<span class="delimiter">}</span>

	<span class="keyword">def</span> <a title="(invalidatedSrcs: Set[java.io.File],previous: sbt.inc.Analysis)sbt.inc.Analysis" id="112397">prune</a><span class="delimiter">(</span><a title="Set[java.io.File]" id="117114">invalidatedSrcs</a>: <span title="Set[java.io.File]">Set</span><span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="sbt.inc.Analysis" id="117115">previous</a>: <a href="Analysis.scala.html#18789" title="sbt.inc.Analysis">Analysis</a><span class="delimiter">)</span>: <a href="Analysis.scala.html#18789" title="sbt.inc.Analysis">Analysis</a> =
	<span class="delimiter">{</span>
		<a href="IO.scala.html#10433" title="object sbt.IO">IO</a>.<a href="IO.scala.html#33506" title="(files: Iterable[java.io.File])Unit">delete</a><span class="delimiter">(</span> <a href="#117114" title="Set[java.io.File]">invalidatedSrcs</a>.<span title="(f: (java.io.File) =&gt; Traversable[java.io.File])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[java.io.File],java.io.File,scala.collection.immutable.Set[java.io.File]])scala.collection.immutable.Set[java.io.File]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set.Coll,java.io.File,scala.collection.immutable.Set[java.io.File]]" class="delimiter">(</span><a href="#117115" title="sbt.inc.Analysis">previous</a>.<a href="Analysis.scala.html#111427" title="=&gt; sbt.inc.Relations">relations</a>.<a href="Relations.scala.html#111467" title="(src: java.io.File)Set[java.io.File]">products</a><span class="delimiter">)</span> <span class="delimiter">)</span>
		<a href="Analysis.scala.html#111429" title="(sources: Iterable[java.io.File])sbt.inc.Analysis">previous</a> -- <a href="#117114" title="Set[java.io.File]">invalidatedSrcs</a>
	<span class="delimiter">}</span>

	<span class="keyword">def</span> <a title="(entry: (String) =&gt; Option[java.io.File],className: (java.io.File) =&gt; Option[String],previous: sbt.inc.Stamps,current: sbt.inc.ReadStamps)(implicit equivS: Equiv[sbt.inc.Stamp])(java.io.File) =&gt; Boolean" id="112398">externalBinaryModified</a><span class="delimiter">(</span><a title="(String) =&gt; Option[java.io.File]" id="118172">entry</a>: String =&gt; Option<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="(java.io.File) =&gt; Option[String]" id="118173">className</a>: File =&gt; Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="sbt.inc.Stamps" id="118174">previous</a>: <a href="Stamp.scala.html#19113" title="sbt.inc.Stamps">Stamps</a>, <a title="sbt.inc.ReadStamps" id="118175">current</a>: <a href="Stamp.scala.html#19068" title="sbt.inc.ReadStamps">ReadStamps</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Equiv[sbt.inc.Stamp]" id="118176">equivS</a>: <span title="Equiv[sbt.inc.Stamp]">Equiv</span><span class="delimiter">[</span>Stamp<span class="delimiter">]</span><span class="delimiter">)</span>: File =&gt; Boolean =
		<a title="java.io.File" id="119428">dependsOn</a> =&gt;
			<a href="#112401" title="(o: Option[Boolean])Boolean">orTrue</a><span class="delimiter">(</span>
				<span class="keyword">for</span> <span class="delimiter">{</span>
					<a title="String" id="119437">name</a> &lt;- <a href="#118173" title="(v1: java.io.File)Option[String]">className</a><span title="(f: (String) =&gt; Option[Boolean])Option[Boolean]" class="delimiter">(</span><a href="#119428" title="java.io.File">dependsOn</a><span class="delimiter">)</span>
					<a title="java.io.File" id="119444">e</a> &lt;- <a href="#118172" title="(v1: String)Option[java.io.File]">entry</a><span title="(f: (java.io.File) =&gt; Boolean)Option[Boolean]" class="delimiter">(</span><a href="#119437" title="String">name</a><span class="delimiter">)</span>
				<span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
					<span class="keyword">val</span> <a title="java.io.File" id="119445">resolved</a> = <a href="Locate.scala.html#19039" title="object sbt.inc.Locate">Locate</a>.<a href="Locate.scala.html#112507" title="(f: java.io.File,className: String)java.io.File">resolve</a><span class="delimiter">(</span><a href="#119444" title="java.io.File">e</a>, <a href="#119437" title="String">name</a><span class="delimiter">)</span>
					<span title="(x$1: Boolean)Boolean" class="delimiter">(</span><a href="#119445" title="(x$1: AnyRef)Boolean">resolved</a> != <a href="#119428" title="java.io.File">dependsOn</a><span class="delimiter">)</span> || <span title="=&gt; Boolean">!</span><a href="#118176" title="Equiv[sbt.inc.Stamp]">equivS</a>.<span title="(x: sbt.inc.Stamp,y: sbt.inc.Stamp)Boolean">equiv</span><span class="delimiter">(</span><a href="#118174" title="sbt.inc.Stamps">previous</a>.<a href="Stamp.scala.html#111448" title="(bin: java.io.File)sbt.inc.Stamp">binary</a><span class="delimiter">(</span><a href="#119428" title="java.io.File">dependsOn</a><span class="delimiter">)</span>, <a href="#118175" title="sbt.inc.ReadStamps">current</a>.<a href="Stamp.scala.html#111448" title="(bin: java.io.File)sbt.inc.Stamp">binary</a><span class="delimiter">(</span><a href="#119445" title="java.io.File">resolved</a><span class="delimiter">)</span><span class="delimiter">)</span>
				<span class="delimiter">}</span>
			<span class="delimiter">)</span>

	<span class="keyword">def</span> <a title="(entry: (String) =&gt; Option[java.io.File],forEntry: (java.io.File) =&gt; Option[sbt.inc.Analysis])(String) =&gt; xsbti.api.Source" id="112399">currentExternalAPI</a><span class="delimiter">(</span><a title="(String) =&gt; Option[java.io.File]" id="118196">entry</a>: String =&gt; Option<span class="delimiter">[</span>File<span class="delimiter">]</span>, <a title="(java.io.File) =&gt; Option[sbt.inc.Analysis]" id="118197">forEntry</a>: File =&gt; Option<span class="delimiter">[</span>Analysis<span class="delimiter">]</span><span class="delimiter">)</span>: String =&gt; Source =
		<a title="String" id="119464">className</a> =&gt;
			<a href="#112400" title="(o: Option[xsbti.api.Source])xsbti.api.Source">orEmpty</a><span class="delimiter">(</span>
				<span class="keyword">for</span> <span class="delimiter">{</span>
					<a title="java.io.File" id="119473">e</a> &lt;- <a href="#118196" title="(v1: String)Option[java.io.File]">entry</a><span title="(f: (java.io.File) =&gt; Option[xsbti.api.Source])Option[xsbti.api.Source]" class="delimiter">(</span><a href="#119464" title="String">className</a><span class="delimiter">)</span>
					<a title="sbt.inc.Analysis" id="119480">analysis</a> &lt;- <a href="#118197" title="(v1: java.io.File)Option[sbt.inc.Analysis]">forEntry</a><span title="(f: (sbt.inc.Analysis) =&gt; Option[xsbti.api.Source])Option[xsbti.api.Source]" class="delimiter">(</span><a href="#119473" title="java.io.File">e</a><span class="delimiter">)</span>
					<a title="java.io.File" id="119486">src</a> &lt;- <a href="#119480" title="sbt.inc.Analysis">analysis</a>.<a href="Analysis.scala.html#111427" title="=&gt; sbt.inc.Relations">relations</a>.<a href="Relations.scala.html#111468" title="(prod: java.io.File)Set[java.io.File]">produced</a><span class="delimiter">(</span><a href="Locate.scala.html#19039" title="object sbt.inc.Locate">Locate</a>.<a href="Locate.scala.html#112507" title="(f: java.io.File,className: String)java.io.File">resolve</a><span class="delimiter">(</span><a href="#119473" title="java.io.File">e</a>, <a href="#119464" title="String">className</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: (java.io.File) =&gt; xsbti.api.Source)Option[xsbti.api.Source]">headOption</span>
				<span class="delimiter">}</span> <span class="keyword">yield</span>
					<a href="#119480" title="sbt.inc.Analysis">analysis</a>.<a href="Analysis.scala.html#111426" title="=&gt; sbt.inc.APIs">apis</a>.<a href="APIs.scala.html#110992" title="(src: java.io.File)xsbti.api.Source">internalAPI</a><span class="delimiter">(</span><a href="#119486" title="java.io.File">src</a><span class="delimiter">)</span>
			<span class="delimiter">)</span>

	<span class="keyword">def</span> <a title="(o: Option[xsbti.api.Source])xsbti.api.Source" id="112400">orEmpty</a><span class="delimiter">(</span><a title="Option[xsbti.api.Source]" id="119465">o</a>: <span title="Option[xsbti.api.Source]">Option</span><span class="delimiter">[</span>Source<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="xsbti/api/Source.java.html#19381" title="xsbti.api.Source">Source</a> = <a href="#119465" title="(default: =&gt; xsbti.api.Source)xsbti.api.Source">o</a> getOrElse <a href="APIs.scala.html#18844" title="object sbt.inc.APIs">APIs</a>.<a href="APIs.scala.html#110987" title="=&gt; xsbti.api.Source">emptySource</a>
	<span class="keyword">def</span> <a title="(o: Option[Boolean])Boolean" id="112401">orTrue</a><span class="delimiter">(</span><a title="Option[Boolean]" id="119429">o</a>: <span title="Option[Boolean]">Option</span><span class="delimiter">[</span>Boolean<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#119429" title="(default: =&gt; Boolean)Boolean">o</a> getOrElse <span title="Boolean(true)" class="keyword">true</span>
	<span class="comment">// unmodifiedSources should not contain any sources in the previous compilation run</span>
	<span class="comment">//  (this may unnecessarily invalidate them otherwise)</span>
	<span class="comment">/*def scopeInvalidation(previous: Analysis, otherSources: Set[File], names: NameChanges): Set[File] =
	{
		val newNames = newTypes ++ names.newTerms
		val newMap = pkgNameMap(newNames)
		otherSources filter { src =&gt; scopeAffected(previous.extAPI(src), previous.srcDependencies(src), newNames, newMap) }
	}

	def scopeAffected(api: Source, srcDependencies: Iterable[Source], newNames: Set[String], newMap: Map[String, List[String]]): Boolean =
		collisions_?(TopLevel.names(api.definitions), newNames) ||
			pkgs(api) exists {p =&gt; shadowed_?(p, srcDependencies, newMap) }

	def collisions_?(existing: Set[String], newNames: Map[String, List[String]]): Boolean =
		!(existing ** newNames).isEmpty

	// A proper implementation requires the actual symbol names used.  This is a crude approximation in the meantime.
	def shadowed_?(fromPkg: List[String], srcDependencies: Iterable[Source], newNames: Map[String, List[String]]): Boolean =
	{
		lazy val newPN = newNames.filter { pn =&gt; properSubPkg(fromPkg, pn._2) }

		def isShadowed(usedName: String): Boolean =
		{
			val (usedPkg, name) = pkgAndName(usedName)
			newPN.get(name).forall { nPkg =&gt; properSubPkg(usedPkg, nPkg) }
		}

		val usedNames = TopLevel.names(srcDependencies) // conservative approximation of referenced top-level names
		usedNames exists isShadowed
	}
	def pkgNameMap(names: Iterable[String]): Map[String, List[String]] =
		(names map pkgAndName).toMap
	def pkgAndName(s: String) =
	{
		val period = s.lastIndexOf('.')
		if(period &lt; 0) (Nil, s) else (s.substring(0, period).split(&quot;\\.&quot;), s.substring(period+1))
	}
	def pkg(s: String) = pkgAndName(s)._1
	def properSubPkg(testParent: Seq[String], testSub: Seq[String]) = testParent.length &lt; testSub.length &amp;&amp; testSub.startsWith(testParent)
	def pkgs(api: Source) = names(api :: Nil).map(pkg)*/</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>